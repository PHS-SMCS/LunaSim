<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: CurvedLinkReshapingTool.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: CurvedLinkReshapingTool.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>"use strict";
/*
*  Copyright (C) 1998-2023 by Northwoods Software Corporation. All Rights Reserved.
*/

// A custom LinkReshapingTool that shows only a single reshape handle on a Bezier curved Link.
// Dragging that handle changes the value of {@link Link#curviness}.

/*
* This is an extension and not part of the main GoJS library.
* Note that the API for this class may change with any version, even point releases.
* If you intend to use an extension in production, you should copy the code to your own source directory.
* Extensions can be found in the GoJS kit under the extensions or extensionsJSM folders.
* See the Extensions intro page (https://gojs.net/latest/intro/extensions.html) for more information.
*/

/**
* @constructor
* @extends LinkReshapingTool
* @class
* This CurvedLinkReshapingTool class allows for a Link's path to be modified by the user
* via the dragging of a single tool handle at the middle of the link.
*/
export function CurvedLinkReshapingTool() {
  go.LinkReshapingTool.call(this);
  /** @type {number} */
  this._originalCurviness = NaN;
}
go.Diagram.inherit(CurvedLinkReshapingTool, go.LinkReshapingTool);

/**
* @this {CurvedLinkReshapingTool}
* @param {Shape} pathshape
* @return {Adornment}
*/
CurvedLinkReshapingTool.prototype.makeAdornment = function(pathshape) {
  var link = pathshape.part;
  if (link !== null &amp;&amp; link.curve === go.Link.Bezier &amp;&amp; link.pointsCount === 4) {
    var adornment = new go.Adornment();
    adornment.type = go.Panel.Link;
    var h = this.makeHandle();
    this.setReshapingBehavior(h, go.LinkReshapingTool.All);
    h.cursor = 'move';
    adornment.add(h);
    adornment.category = this.name;
    adornment.adornedObject = pathshape;
    return adornment;
  } else {
    return go.LinkReshapingTool.prototype.makeAdornment.call(this, pathshape);
  }
};

/**
* @this {CurvedLinkReshapingTool}
*/
CurvedLinkReshapingTool.prototype.doActivate = function() {
  go.LinkReshapingTool.prototype.doActivate.call(this);
  this._originalCurviness = this.adornedLink.curviness;
};

/**
* @this {CurvedLinkReshapingTool}
*/
CurvedLinkReshapingTool.prototype.doCancel = function() {
  this.adornedLink.curviness = this._originalCurviness;
  go.LinkReshapingTool.prototype.doCancel.call(this);
};

/**
* @this {CurvedLinkReshapingTool}
* @param {Point} newpt
* @return {Point}
*/
CurvedLinkReshapingTool.prototype.reshape = function(newpt) {
  var link = this.adornedLink;
  if (link !== null &amp;&amp; link.curve === go.Link.Bezier &amp;&amp; link.pointsCount === 4) {
    var start = link.getPoint(0);
    var end = link.getPoint(3);
    var ang = start.directionPoint(end);
    var mid = new go.Point((start.x + end.x) / 2, (start.y + end.y) / 2);
    var a = new go.Point(9999, 0).rotate(ang + 90).add(mid);
    var b = new go.Point(9999, 0).rotate(ang - 90).add(mid);
    var q = newpt.copy().projectOntoLineSegmentPoint(a, b);
    var curviness = Math.sqrt(mid.distanceSquaredPoint(q));
    if (link.fromPort === link.toPort) {
      if (newpt.y &lt; link.fromPort.getDocumentPoint(go.Spot.Center).y) curviness = -curviness;
    } else {
      var diff = mid.directionPoint(q) - ang;
      if ((diff > 0 &amp;&amp; diff &lt; 180) || (diff &lt; -180)) curviness = -curviness;
    }
    link.curviness = curviness;
    return q;
  } else {
    go.LinkReshapingTool.prototype.reshape.call(this, newpt);
  }
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-TabsManagement.html">TabsManagement</a></li><li><a href="module-editor.html">editor</a></li><li><a href="module-editor.module_CurvedLinkReshapingTool.html">CurvedLinkReshapingTool</a></li><li><a href="module-engine.html">engine</a></li><li><a href="module-translator.html">translator</a></li></ul><h3>Classes</h3><ul><li><a href="CurvedLinkReshapingTool.html">CurvedLinkReshapingTool</a></li></ul><h3>Global</h3><ul><li><a href="global.html#SD">SD</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.4</a> on Sun Jun 08 2025 16:22:26 GMT-0400 (Eastern Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
